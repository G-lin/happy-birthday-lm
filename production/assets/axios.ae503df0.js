import{b as e,a as t,T as o,l as a}from"./function.bbd77873.js";import"./index.dab47157.js";import{$ as r}from"./vant.d7724c5c.js";import{r as s}from"./index.435cda4d.js";e.interceptors.request.use((e=>e),(e=>Promise.reject(e)));const n=function({isLock:n=!1,allUrl:c=!1,allSuccess:i=!1,url:l="",method:m="get",contentType:d="application/x-www-form-urlencoded; charset=UTF-8",data:u={},timeout:g=parseInt("20000"),timeShowLoadAnimation:f=555,success:p=function(){},fail:h=function(){}}={}){let S=null;if(n){if(S=t.md5(l+"_"+m+"_"+JSON.stringify(u)),t.getSessionStorage(S))return;t.setSessionStorage(S,!0)}let T=null,y=setTimeout((()=>{T=o.loading({message:"加载中...",forbidClick:!0,duration:0}),n&&t.removeSessionStorage(S)}),f),b={url:c?l:"http://82.156.70.219/muteki/api"+l,method:m,headers:{"Content-Type":d,token:t.getLocationStorage("token")},timeout:g};u.__t=(new Date).getTime(),d.includes("multipart/form-data")?b.data=u:"GET"===m.toUpperCase()?b.params=u:b.data=a.stringify(u,{indices:!1}),e(b).then((e=>{if(n&&t.removeSessionStorage(S),clearTimeout(y),null!=T&&T.clear(),c)try{p(e.data)}catch(o){console.error(o)}else if(401!==e.data.code)if(i)try{p(e.data)}catch(o){console.error(o)}else{if(200!==e.data.code)return r.errorMsg(e.data.msg),void function(e,t={}){console.warn(e);try{t instanceof Object?console.table(t):console.log(t)}catch(o){console.log("此浏览器不支持console.table()",o,"---错误详情:",t)}console.warn("↑↑以上为错误详情↑↑↑↑↑")}(`请求出错url:${l}`,e.data);try{p(e.data.data)}catch(o){console.error(o)}}else{r.errorMsg("登陆过期，自动登录中。。。");let e=setTimeout((()=>{clearTimeout(e),s.replace("login")}),3e3)}})).catch((o=>{if(n&&t.removeSessionStorage(S),clearTimeout(y),null!=T&&T.clear(),e.isCancel(o))try{h(o)}catch(a){console.error(a)}else{r.alert({title:"系统异常",message:`message:${o.message}\r\n url:${l}`}),console.warn(`请求失败url:${l}`,o);try{h(o)}catch(a){console.error(a)}}}))};export{n as m};
